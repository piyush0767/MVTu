
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Advanced Milk Route Analytics</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>

  <!-- Language Toggle -->
  <button onclick="toggleLanguage()" class="language-btn">ğŸŒ Toggle Language</button>

  <!-- Driver Login -->
  <div id="driverLoginSection">
    <div class="login-container">
      <h2>ğŸš› Driver Login</h2>
      <div class="input-group">
        <label id="labelRoute">Route Number</label>
        <input id="routeNumber" type="text" placeholder="Enter route number">
      </div>

      <div class="input-group">
        <label id="labelPassword">Password</label>
        <input type="password" id="password" placeholder="Enter password">
      </div>

      <div class="input-group">
        <label id="shiftLabel">Select Shift</label>
        <select id="shiftSelector">
          <option>Morning</option>
          <option>Evening</option>
        </select>
      </div>

      <button id="driverLoginButton" onclick="driverLogin()" class="primary-btn">Login</button>
    </div>
  </div>

  <!-- Admin Login -->
  <div id="adminLoginSection">
    <div class="login-container">
      <h2 id="adminLoginTitle">ğŸ‘¨â€ğŸ’¼ Admin Login</h2>
      <div class="input-group">
        <input id="adminUsername" placeholder="Username" type="text">
      </div>
      <div class="input-group">
        <input type="password" id="adminPassword" placeholder="Password">
      </div>
      <button onclick="adminLogin()" class="primary-btn">Login as Admin</button>
    </div>
  </div>

  <!-- Driver Section -->
  <div class="driver-section hidden">
    <div class="driver-header">
      <h3>Welcome, Driver!</h3>
      <div class="driver-info">
        <div class="info-card">
          <span id="driverRoute"></span>
        </div>
        <div class="info-card">
          <span id="shiftDisplay"></span>
        </div>
        <div class="info-card">
          <span id="loginTime"></span>
        </div>
      </div>
    </div>
    <div id="societyList" class="society-grid"></div>
    <button onclick="logout()" class="logout-btn">Logout</button>
  </div>

  <!-- Admin Panel -->
  <div class="admin-section hidden">
    <!-- Advanced Navigation -->
    <div class="admin-header">
      <h1>ğŸ“Š Advanced Route Analytics Dashboard</h1>
      <div class="admin-tabs">
        <button onclick="showAdminTab('dashboard')" class="tab-btn active">ğŸ“Š Dashboard</button>
        <button onclick="showAdminTab('analytics')" class="tab-btn">ğŸ“ˆ Analytics</button>
        <button onclick="showAdminTab('routes')" class="tab-btn">ğŸšš Routes</button>
        <button onclick="showAdminTab('performance')" class="tab-btn">âš¡ Performance</button>
        <button onclick="showAdminTab('reports')" class="tab-btn">ğŸ“‹ Reports</button>
        <button onclick="showAdminTab('settings')" class="tab-btn">âš™ï¸ Settings</button>
      </div>
    </div>

    <!-- DASHBOARD TAB -->
    <div class="admin-tab" id="adminTab-dashboard">
      <div class="dashboard-grid">
        <!-- Key Metrics -->
        <div class="metric-cards">
          <div class="metric-card">
            <div class="metric-value" id="totalRoutes">0</div>
            <div class="metric-label">Total Routes</div>
          </div>
          <div class="metric-card">
            <div class="metric-value" id="activeTracks">0</div>
            <div class="metric-label">Active Tracks Today</div>
          </div>
          <div class="metric-card">
            <div class="metric-value" id="avgHoldTime">0</div>
            <div class="metric-label">Avg Hold Time</div>
          </div>
          <div class="metric-card">
            <div class="metric-value" id="efficiency">0%</div>
            <div class="metric-label">Route Efficiency</div>
          </div>
        </div>

        <!-- Today's Activity Chart -->
        <div class="chart-container">
          <h3>Today's Route Activity</h3>
          <canvas id="todayActivityChart"></canvas>
        </div>

        <!-- Route Performance Comparison -->
        <div class="chart-container">
          <h3>Route Performance Comparison</h3>
          <canvas id="performanceComparisonChart"></canvas>
        </div>

        <!-- Live Status Table -->
        <div class="live-status">
          <h3>Live Route Status</h3>
          <table id="liveStatusTable">
            <thead>
              <tr>
                <th>Route</th>
                <th>Shift</th>
                <th>Current Society</th>
                <th>Status</th>
                <th>Hold Time</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- ANALYTICS TAB -->
    <div class="admin-tab hidden" id="adminTab-analytics">
      <div class="analytics-controls">
        <h2>ğŸ“ˆ Advanced Analytics</h2>
        <div class="filter-row">
          <select id="analyticsRoute">
            <option value="">All Routes</option>
          </select>
          <input type="date" id="analyticsStartDate">
          <input type="date" id="analyticsEndDate">
          <select id="analyticsMetric">
            <option value="holdTime">Hold Time Analysis</option>
            <option value="efficiency">Route Efficiency</option>
            <option value="comparison">Day Comparison</option>
            <option value="society">Society Performance</option>
          </select>
          <button onclick="generateAnalytics()" class="primary-btn">Generate</button>
        </div>
      </div>

      <div class="analytics-results">
        <!-- Trend Analysis Chart -->
        <div class="chart-container">
          <h3 id="analyticsChartTitle">Analytics Results</h3>
          <canvas id="analyticsChart"></canvas>
        </div>

        <!-- Detailed Statistics -->
        <div class="stats-grid">
          <div class="stat-card">
            <h4>Best Performance</h4>
            <div id="bestPerformance">-</div>
          </div>
          <div class="stat-card">
            <h4>Worst Performance</h4>
            <div id="worstPerformance">-</div>
          </div>
          <div class="stat-card">
            <h4>Average Time</h4>
            <div id="averageTime">-</div>
          </div>
          <div class="stat-card">
            <h4>Improvement</h4>
            <div id="improvement">-</div>
          </div>
        </div>

        <!-- Comparison Table -->
        <div class="comparison-table">
          <h3>Detailed Comparison</h3>
          <table id="comparisonTable">
            <thead>
              <tr>
                <th>Route/Society</th>
                <th>Yesterday</th>
                <th>Today</th>
                <th>Difference</th>
                <th>Trend</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- ROUTE MANAGEMENT TAB -->
    <div class="admin-tab hidden" id="adminTab-routes">
      <h2>ğŸšš Route & Society Management</h2>
      
      <div class="section-grid">
        <!-- Add New Route -->
        <div class="section">
          <h3>Add New Route</h3>
          <div class="input-group">
            <input id="newRouteNumber" placeholder="Route Number" type="text">
            <button onclick="addRoute()" class="primary-btn">Add Route</button>
          </div>
        </div>

        <!-- Bulk Add Route -->
        <div class="section">
          <h3>Bulk Add Route & Societies</h3>
          <input id="bulkRouteNumber" placeholder="Route Number" type="text">
          <textarea id="bulkSocieties" placeholder="Paste societies (one per line or comma separated)" rows="5"></textarea>
          <button onclick="bulkAddRoute()" class="primary-btn">Bulk Add</button>
        </div>

        <!-- Edit Existing Route -->
        <div class="section">
          <h3>Edit Route</h3>
          <select id="routeSelector" onchange="loadSocietiesForEdit()">
            <option value="">Select Route</option>
          </select>
          <div id="societyEditor"></div>
          <div class="input-group">
            <input id="newSocietyName" placeholder="New Society Name" type="text">
            <button onclick="addSociety()" class="primary-btn">Add Society</button>
          </div>
        </div>
      </div>
    </div>

    <!-- PERFORMANCE TAB -->
    <div class="admin-tab hidden" id="adminTab-performance">
      <h2>âš¡ Performance Metrics</h2>
      
      <div class="performance-filters">
        <select id="perfRoute">
          <option value="">All Routes</option>
        </select>
        <select id="perfPeriod">
          <option value="today">Today</option>
          <option value="week">This Week</option>
          <option value="month">This Month</option>
        </select>
        <button onclick="loadPerformanceData()" class="primary-btn">Load Data</button>
      </div>

      <div class="performance-grid">
        <!-- Performance Charts -->
        <div class="chart-container">
          <h3>Route Completion Times</h3>
          <canvas id="completionChart"></canvas>
        </div>

        <div class="chart-container">
          <h3>Society Hold Times</h3>
          <canvas id="holdTimeChart"></canvas>
        </div>

        <!-- Performance Rankings -->
        <div class="rankings">
          <h3>Top Performing Routes</h3>
          <div id="topRoutes" class="ranking-list"></div>
        </div>

        <div class="rankings">
          <h3>Routes Needing Attention</h3>
          <div id="poorRoutes" class="ranking-list"></div>
        </div>
      </div>
    </div>

    <!-- REPORTS TAB -->
    <div class="admin-tab hidden" id="adminTab-reports">
      <h2>ğŸ“‹ Reports & Export</h2>
      
      <div class="report-controls">
        <div class="filter-row">
          <select id="reportType">
            <option value="daily">Daily Report</option>
            <option value="weekly">Weekly Summary</option>
            <option value="monthly">Monthly Analysis</option>
            <option value="custom">Custom Report</option>
          </select>
          <input type="date" id="reportStartDate">
          <input type="date" id="reportEndDate">
          <select id="reportRoute">
            <option value="">All Routes</option>
          </select>
          <button onclick="generateReport()" class="primary-btn">Generate Report</button>
          <button onclick="exportReport()" class="export-btn">ğŸ“„ Export PDF</button>
        </div>
      </div>

      <div id="reportResults" class="report-container">
        <!-- Report content will be generated here -->
      </div>
    </div>

    <!-- SETTINGS TAB -->
    <div class="admin-tab hidden" id="adminTab-settings">
      <h2>âš™ï¸ System Settings</h2>
      
      <div class="settings-grid">
        <div class="setting-group">
          <h3>Alert Thresholds</h3>
          <div class="input-group">
            <label>Max Hold Time (minutes):</label>
            <input type="number" id="maxHoldTime" value="30">
          </div>
          <div class="input-group">
            <label>Route Delay Alert (minutes):</label>
            <input type="number" id="delayAlert" value="15">
          </div>
        </div>

        <div class="setting-group">
          <h3>Data Management</h3>
          <button onclick="backupData()" class="primary-btn">ğŸ“¦ Backup Data</button>
          <button onclick="resetApp()" class="danger-btn">ğŸ—‘ï¸ Reset All Data</button>
        </div>

        <div class="setting-group">
          <h3>System Info</h3>
          <div class="info-display">
            <p>Total Records: <span id="totalRecords">0</span></p>
            <p>Data Size: <span id="dataSize">0 KB</span></p>
            <p>Last Backup: <span id="lastBackup">Never</span></p>
          </div>
        </div>
      </div>
    </div>

    <button onclick="logout()" class="logout-btn">Logout</button>
  </div>

  <!-- Toast Notification -->
  <div id="toast" class="toast"></div>

  <script src="script.js"></script>
</body>
</html>
