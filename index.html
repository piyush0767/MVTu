<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Milk Route Tracker</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- Language Toggle -->
  <button onclick="toggleLanguage()" class="language-btn">🌐 Toggle Language</button>

  <!-- Driver Login -->
  <div id="driverLoginSection">
    <h2>Driver Login</h2>
    <label id="labelRoute">Route Number</label><br>
    <input id="routeNumber" type="text"><br>

    <label id="labelPassword">Password</label><br>
    <input type="password" id="password"><br>

    <label id="shiftLabel">Select Shift</label><br>
    <select id="shiftSelector">
      <option>Morning</option>
      <option>Evening</option>
    </select><br><br>

    <button id="driverLoginButton" onclick="driverLogin()">Login</button>
  </div>

  <!-- Admin Login -->
  <div id="adminLoginSection">
    <h2 id="adminLoginTitle">Admin Login</h2>
    <input id="adminUsername" placeholder="Username" type="text"><br>
    <input type="password" id="adminPassword" placeholder="Password"><br>
    <button onclick="adminLogin()">Login as Admin</button>
  </div>

  <!-- Driver Section (Initially Hidden) -->
  <div class="driver-section hidden">
    <h3>Welcome, Driver!</h3>
    <p id="driverRoute"></p>
    <p id="shiftDisplay"></p>
    <p id="loginTime"></p>
    <div id="societyList"></div>
  </div>

  <!-- Admin Panel (Initially Hidden) -->
  <div class="admin-section hidden">
    <!-- Navigation Tabs -->
    <div class="admin-tabs">
      <button onclick="showAdminTab('routes')">🚚 Routes</button>
      <button onclick="showAdminTab('logs')">📋 Logs</button>
      <button onclick="showAdminTab('summary')">📊 Summary</button>
      <button onclick="showAdminTab('comparison')">🔄 Compare</button>
      <button onclick="showAdminTab('society')">🏢 Society</button>
      <button onclick="showAdminTab('historical')">📈 History</button>
      <button onclick="showAdminTab('settings')">⚙️ Settings</button>
    </div>

    <!-- ROUTE MANAGEMENT TAB -->
    <div class="admin-tab" id="adminTab-routes">
      <h2>🚚 Route & Society Management</h2>
      
      <!-- Add New Route -->
      <div class="section">
        <h3>Add New Route</h3>
        <input id="newRouteNumber" placeholder="Route Number" type="text">
        <button onclick="addRoute()">Add Route</button>
      </div>

      <!-- Bulk Add Route -->
      <div class="section">
        <h3>Bulk Add Route & Societies</h3>
        <input id="bulkRouteNumber" placeholder="Route Number" type="text"><br>
        <textarea id="bulkSocieties" placeholder="Paste societies (one per line or comma separated)"></textarea><br>
        <button onclick="bulkAddRoute()">Bulk Add</button>
      </div>

      <!-- Edit Existing Route -->
      <div class="section">
        <h3>Edit Route</h3>
        <select id="routeSelector" onchange="loadSocietiesForEdit()"></select>
        <div id="societyEditor"></div>
        <input id="newSocietyName" placeholder="New Society Name" type="text">
        <button onclick="addSociety()">Add Society</button>
      </div>
    </div>

    <!-- LOGS TAB -->
    <div class="admin-tab hidden" id="adminTab-logs">
      <h2>📋 Driver Visit Logs</h2>
      <div class="filters">
        <label>Date:</label>
        <input type="date" id="filterDate">
        
        <label>Route:</label>
        <select id="filterRoute"></select>
        
        <label>Shift:</label>
        <select id="filterShift">
          <option value="">All Shifts</option>
          <option value="Morning">Morning</option>
          <option value="Evening">Evening</option>
        </select>
        
        <button onclick="applyAdminFilters()">🔍 Apply Filters</button>
      </div>
      <div id="adminStatusTable"></div>
    </div>

    <!-- SUMMARY TAB -->
    <div class="admin-tab hidden" id="adminTab-summary">
      <h2>📊 Daily Visit Summary</h2>
      <div class="filters">
        <label>Date:</label>
        <input type="date" id="summaryDateFilter">
        
        <label>Route:</label>
        <select id="summaryRouteFilter"></select>
        
        <label>Shift:</label>
        <select id="summaryShiftFilter">
          <option value="">Both Shifts</option>
          <option value="Morning">Morning</option>
          <option value="Evening">Evening</option>
        </select>
        
        <button onclick="loadAdminSummary()">🔍 View Summary</button>
        <button onclick="exportCSV()">📤 Export CSV</button>
      </div>

      <table id="summaryTable">
        <thead>
          <tr>
            <th>Shift</th>
            <th>Society</th>
            <th>Arrival</th>
            <th>Departure</th>
            <th>Duration</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- ROUTE COMPARISON TAB -->
    <div class="admin-tab hidden" id="adminTab-comparison">
      <h2>🔄 Route Comparison Analytics</h2>
      <div class="filters">
        <label>Route:</label>
        <select id="comparisonRoute"></select>
        
        <label>Date 1:</label>
        <input type="date" id="comparisonDate1">
        
        <label>Date 2:</label>
        <input type="date" id="comparisonDate2">
        
        <label>Shift:</label>
        <select id="comparisonShift">
          <option value="">Both Shifts</option>
          <option value="Morning">Morning</option>
          <option value="Evening">Evening</option>
        </select>
        
        <button onclick="loadRouteComparison()">🔍 Compare Days</button>
      </div>

      <table id="comparisonTable">
        <thead>
          <tr>
            <th>Shift</th>
            <th>Society</th>
            <th colspan="2">Date 1 Data</th>
            <th colspan="2">Date 2 Data</th>
          </tr>
          <tr>
            <th></th>
            <th></th>
            <th>Arrival</th>
            <th>Duration</th>
            <th>Arrival</th>
            <th>Duration</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- SOCIETY ANALYTICS TAB -->
    <div class="admin-tab hidden" id="adminTab-society">
      <h2>🏢 Society-wise Analytics</h2>
      <div class="filters">
        <label>Route:</label>
        <select id="societyAnalyticsRoute" onchange="populateSocietyDropdown()"></select>
        
        <label>Society:</label>
        <select id="societyAnalyticsName"></select>
        
        <label>From Date:</label>
        <input type="date" id="societyFromDate">
        
        <label>To Date:</label>
        <input type="date" id="societyToDate">
        
        <button onclick="loadSocietyAnalytics()">🔍 View Analytics</button>
      </div>

      <table id="societyAnalyticsTable">
        <thead>
          <tr>
            <th>Date</th>
            <th>Shift</th>
            <th>Arrival</th>
            <th>Departure</th>
            <th>Hold Time</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- HISTORICAL DATA TAB -->
    <div class="admin-tab hidden" id="adminTab-historical">
      <h2>📈 Historical Data Analysis</h2>
      <div class="filters">
        <label>Route:</label>
        <select id="historicalRoute"></select>
        
        <label>From Date:</label>
        <input type="date" id="historicalFromDate">
        
        <label>To Date:</label>
        <input type="date" id="historicalToDate">
        
        <button onclick="loadHistoricalData()">🔍 Load History</button>
      </div>

      <table id="historicalTable">
        <thead>
          <tr>
            <th>Date</th>
            <th>Shift</th>
            <th>Society</th>
            <th>Arrival</th>
            <th>Departure</th>
            <th>Hold Time</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- SETTINGS TAB -->
    <div class="admin-tab hidden" id="adminTab-settings">
      <h2>⚙️ Admin Settings</h2>
      <button onclick="resetApp()">🧨 Reset All Data</button>
    </div>
  </div>

  <!-- Toast Notification -->
  <div id="toast" class="toast"></div>

  <!-- Reset App -->
  <button onclick="resetApp()" class="reset-btn">🔁 Reset App</button>

  <script src="script.js"></script>
</body>
</html>
